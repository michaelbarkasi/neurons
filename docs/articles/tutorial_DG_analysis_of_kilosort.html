<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dichotomized Gaussian analysis of KiloSort4 data ‚Ä¢ neurons</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dichotomized Gaussian analysis of KiloSort4 data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neurons</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Introduction</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Package Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Installation</h6></li>
    <li><a class="dropdown-item" href="../articles/install.html">Installation instructions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial_DG_analysis_of_kilosort.html">Dichotomized Gaussian analysis of KiloSort4 data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Legal</h6></li>
    <li><a class="dropdown-item" href="../articles/license.html">Dependency licenses</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/michaelbarkasi/neurons"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../#">üåô</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dichotomized Gaussian analysis of KiloSort4 data</h1>
            
      

      <div class="d-none name"><code>tutorial_DG_analysis_of_kilosort.Rmd</code></div>
    </div>

    
    
<p>This is an example vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span> </span>
<span><span class="co"># Load neurons package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">neurons</span><span class="op">)</span> </span>
<span><span class="co"># Set width of markdown code outputs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="co"># Set path to data </span></span>
<span><span class="va">demo_data</span> <span class="op">&lt;-</span> <span class="st">"/Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/_lateralized_recurrent_pathways/dichot-gaussian/data_demo"</span></span></code></pre></div>
<p>I removed the recording ‚Äú2025-04-06_13-26-57‚Äù because each cell in it
had only one responsive trial.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># old recordings used 1520 ms of silence, once settled</span></span>
<span><span class="co"># ... settling seems to take 500 ms</span></span>
<span><span class="va">spike.rasters.kilo4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess.kilo4.html">preprocess.kilo4</a></span><span class="op">(</span></span>
<span>  <span class="co"># ... for stimulus</span></span>
<span>  <span class="co">#trial_time_start = -100, </span></span>
<span>  <span class="co">#trial_time_end = 1800 </span></span>
<span>  <span class="co"># ... for silence</span></span>
<span>  trial_time_start <span class="op">=</span> <span class="fl">500</span>, </span>
<span>  trial_time_end <span class="op">=</span> <span class="fl">500</span> <span class="op">+</span> <span class="fl">1520</span>,</span>
<span>  recording.folder <span class="op">=</span> <span class="va">demo_data</span>,</span>
<span>  pure_trials_only <span class="op">=</span> <span class="cn">TRUE</span>,       <span class="co"># Keep only trials with no overlap? </span></span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-02-06_15-53-03/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  183219</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  183219 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  183219</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  29 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  76 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-04-05_11-50-43/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  570256</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  570256 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  570256</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  27 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  90 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-04-06_13-51-14/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  464033</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  464033 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  464033</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  16 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  53 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-04-11_18-09-55/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  763996</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  763996 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  763996</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  11 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  90 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-04-25_12-42-03/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  621464</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  621464 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  621464</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  58 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-06-02_15-13-06/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  430992</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  430992 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  430992</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  53 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-06-03_13-59-05/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  141998</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  141998 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  141998</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  42 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-06-06_14-52-03/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  199674</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  199674 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  199674</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  51 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-06-12_16-11-15/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  294730</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  294730 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  294730</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  58 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-06-20_14-29-41/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  77670</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  77670 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  77670</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  38 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-06-25_12-33-31/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  218798</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  218798 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  218798</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  32 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-07-09_14-56-27/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  185570</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  185570 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  185570</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  30 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-07-24_12-48-13/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  116852</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  116852 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  116852</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  27 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Imported data: /2025-07-30_09-28-20/kilosort4/cluster_info.tsv</span></span>
<span><span class="co">##  spike_clusters, class:  array, dim:  118866</span></span>
<span><span class="co">##  spike_positions, class:  matrix array, dim:  118866 2</span></span>
<span><span class="co">##  spike_times, class:  array, dim:  118866</span></span>
<span><span class="co">##  cluster_group, class:  data.frame, dim:  0 2, col names (1st 5):  cluster_id, group</span></span>
<span><span class="co">##  cluster_info, class:  data.frame, dim:  22 11, col names (1st 5):  cluster_id, Amplitude, ContamPct, KSLabel, amp</span></span></code></pre>
<p>The output is a list with three elements: , , and . The first
element, , is a data frame giving a sparse representation of the spike
rasters from each recording. Each row is a spike, with columns giving
information such as cell number, time, and genotype. Here are the first
few rows of the data frame:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">spikes</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      trial   sample cell time_in_ms      recording_name cluster     genotype   hemisphere</span></span>
<span><span class="co">## 3463     1 11166.39    2   524.7279 2025-02-06_15-53-03      37 not_provided not_provided</span></span>
<span><span class="co">## 3467     1 11170.48    1   528.8199 2025-02-06_15-53-03      26 not_provided not_provided</span></span>
<span><span class="co">## 3505     1 11296.51    1   654.8471 2025-02-06_15-53-03      26 not_provided not_provided</span></span>
<span><span class="co">## 3509     1 11312.48    3   670.8191 2025-02-06_15-53-03      38 not_provided not_provided</span></span>
<span><span class="co">## 3542     1 11409.04    1   767.3772 2025-02-06_15-53-03      26 not_provided not_provided</span></span>
<span><span class="co">## 3562     1 11445.43    1   803.7762 2025-02-06_15-53-03      26 not_provided not_provided</span></span></code></pre>
<p>The second element, , is a list of matrices, one per cell, with rows
corresponding to time bins and columns to trials. Each entry is a binary
indicator of whether the cell fired in that time bin during that trial.
The third element, , is a data frame with rows representing cells,
columns giving information such as cell number, genotype, and number of
spikes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         recording.name cell cluster     genotype   hemisphere num.of.spikes num.of.responsive.trials</span></span>
<span><span class="co">## 1  2025-02-06_15-53-03    2      37 not_provided not_provided           130                       24</span></span>
<span><span class="co">## 2  2025-02-06_15-53-03    1      26 not_provided not_provided           207                       28</span></span>
<span><span class="co">## 3  2025-02-06_15-53-03    3      38 not_provided not_provided           148                       28</span></span>
<span><span class="co">## 4  2025-02-06_15-53-03    4      48 not_provided not_provided            44                       22</span></span>
<span><span class="co">## 5  2025-02-06_15-53-03    5      51 not_provided not_provided            11                        7</span></span>
<span><span class="co">## 6  2025-04-05_11-50-43   11      17 not_provided not_provided          1869                      337</span></span>
<span><span class="co">## 7  2025-04-05_11-50-43   13      34 not_provided not_provided          1457                      271</span></span>
<span><span class="co">## 8  2025-04-05_11-50-43   21      82 not_provided not_provided          2321                      325</span></span>
<span><span class="co">## 9  2025-04-05_11-50-43    6       1 not_provided not_provided          2461                      396</span></span>
<span><span class="co">## 10 2025-04-05_11-50-43    9      12 not_provided not_provided          4153                      355</span></span>
<span><span class="co">## 11 2025-04-05_11-50-43   22      95 not_provided not_provided          2263                      360</span></span>
<span><span class="co">## 12 2025-04-05_11-50-43    8      11 not_provided not_provided          1386                      344</span></span>
<span><span class="co">## 13 2025-04-05_11-50-43    7       6 not_provided not_provided           788                      273</span></span>
<span><span class="co">## 14 2025-04-05_11-50-43   12      22 not_provided not_provided           780                      305</span></span>
<span><span class="co">## 15 2025-04-05_11-50-43   16      51 not_provided not_provided          1226                      247</span></span>
<span><span class="co">## 16 2025-04-05_11-50-43   24      98 not_provided not_provided          2033                      328</span></span>
<span><span class="co">## 17 2025-04-05_11-50-43   23      96 not_provided not_provided          1004                      304</span></span>
<span><span class="co">## 18 2025-04-05_11-50-43   17      62 not_provided not_provided           396                      149</span></span>
<span><span class="co">## 19 2025-04-05_11-50-43   20      80 not_provided not_provided          1900                      304</span></span>
<span><span class="co">## 20 2025-04-05_11-50-43   10      16 not_provided not_provided          1686                      395</span></span>
<span><span class="co">## 21 2025-04-05_11-50-43   15      41 not_provided not_provided          1104                      294</span></span>
<span><span class="co">## 22 2025-04-05_11-50-43   18      67 not_provided not_provided           396                      227</span></span>
<span><span class="co">## 23 2025-04-05_11-50-43   14      35 not_provided not_provided           259                      138</span></span>
<span><span class="co">## 24 2025-04-05_11-50-43   19      69 not_provided not_provided            51                       45</span></span>
<span><span class="co">## 25 2025-04-06_13-51-14   25      25 not_provided not_provided          2344                      455</span></span>
<span><span class="co">## 26 2025-04-06_13-51-14   29      51 not_provided not_provided          8081                      401</span></span>
<span><span class="co">## 27 2025-04-06_13-51-14   27      42 not_provided not_provided          3123                      449</span></span>
<span><span class="co">## 28 2025-04-06_13-51-14   28      43 not_provided not_provided          2433                      449</span></span>
<span><span class="co">## 29 2025-04-06_13-51-14   26      29 not_provided not_provided          2436                      457</span></span>
<span><span class="co">## 30 2025-04-06_13-51-14   30      61 not_provided not_provided          1929                      428</span></span>
<span><span class="co">## 31 2025-04-11_18-09-55   31      22 not_provided not_provided          2289                      259</span></span>
<span><span class="co">## 32 2025-04-11_18-09-55   32      76 not_provided not_provided           502                      180</span></span>
<span><span class="co">## 33 2025-06-02_15-13-06   35       8 not_provided not_provided           624                      171</span></span>
<span><span class="co">## 34 2025-06-02_15-13-06   36      13 not_provided not_provided          3276                      220</span></span>
<span><span class="co">## 35 2025-06-02_15-13-06   37      31 not_provided not_provided           364                      133</span></span>
<span><span class="co">## 36 2025-06-02_15-13-06   34       4 not_provided not_provided            75                       54</span></span>
<span><span class="co">## 37 2025-06-02_15-13-06   33       1 not_provided not_provided           364                      150</span></span>
<span><span class="co">## 38 2025-06-03_13-59-05   38      10 not_provided not_provided           285                      155</span></span>
<span><span class="co">## 39 2025-06-03_13-59-05   46      32 not_provided not_provided           586                      167</span></span>
<span><span class="co">## 40 2025-06-03_13-59-05   47      34 not_provided not_provided            58                       48</span></span>
<span><span class="co">## 41 2025-06-03_13-59-05   44      30 not_provided not_provided            73                       62</span></span>
<span><span class="co">## 42 2025-06-03_13-59-05   43      28 not_provided not_provided            83                       66</span></span>
<span><span class="co">## 43 2025-06-03_13-59-05   41      24 not_provided not_provided           268                      169</span></span>
<span><span class="co">## 44 2025-06-03_13-59-05   42      26 not_provided not_provided           115                       94</span></span>
<span><span class="co">## 45 2025-06-03_13-59-05   45      31 not_provided not_provided           420                      197</span></span>
<span><span class="co">## 46 2025-06-03_13-59-05   39      11 not_provided not_provided           208                       99</span></span>
<span><span class="co">## 47 2025-06-03_13-59-05   40      21 not_provided not_provided            82                       69</span></span>
<span><span class="co">## 48 2025-06-03_13-59-05   48      41 not_provided not_provided            80                       67</span></span>
<span><span class="co">## 49 2025-06-06_14-52-03   49       6 not_provided not_provided          1334                      297</span></span>
<span><span class="co">## 50 2025-06-12_16-11-15   50      28 not_provided not_provided            26                       17</span></span>
<span><span class="co">## 51 2025-06-12_16-11-15   51      55 not_provided not_provided           365                      195</span></span>
<span><span class="co">## 52 2025-07-09_14-56-27   52       3 not_provided not_provided          2587                      449</span></span></code></pre>
<p>With the kilosort4 data preprocessed into spike rasters, the next
step is to convert them into a special class of object from the neuron
package, .</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">neurons.kilo4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load.rasters.as.neurons.html">load.rasters.as.neurons</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">spikes</span>, sample_rt <span class="op">=</span> <span class="fl">1e3</span><span class="op">)</span></span></code></pre></div>
<p>We want to load the spike rasters as s because s come with built-in
methods for estimating autocorrelation parameters with dichotomized
Gaussian simulations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ... set number of sims to run per neuron</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="co"># ... set number of trials to simulate per neuron</span></span>
<span><span class="va">n_trials</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="co"># ... run estimates on data</span></span>
<span><span class="va">autocor.ests.kilo4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.autocorr.params.html">estimate.autocorr.params</a></span><span class="op">(</span></span>
<span>  neuron_list <span class="op">=</span> <span class="va">neurons.kilo4</span>,</span>
<span>  n_trials_per_sim <span class="op">=</span> <span class="va">n_trials</span>, </span>
<span>  n_sims_per_neurons <span class="op">=</span> <span class="va">n_sims</span>, </span>
<span>  bin_count_action <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  A0 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  tau0 <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  ctol <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>  max_evals <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Estimating autocorrelation parameters for neuron 2, 2025-02-06_15-53-03 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 1, 2025-02-06_15-53-03 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 3, 2025-02-06_15-53-03 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 4, 2025-02-06_15-53-03 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 5, 2025-02-06_15-53-03 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 11, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 13, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 21, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 6, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 9, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 22, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 8, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 7, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 12, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 16, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 24, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 23, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 17, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 20, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 10, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 15, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 18, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 14, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 19, 2025-04-05_11-50-43 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 25, 2025-04-06_13-51-14 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 29, 2025-04-06_13-51-14 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 27, 2025-04-06_13-51-14 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 28, 2025-04-06_13-51-14 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 26, 2025-04-06_13-51-14 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 30, 2025-04-06_13-51-14 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 31, 2025-04-11_18-09-55 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 32, 2025-04-11_18-09-55 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 35, 2025-06-02_15-13-06 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 36, 2025-06-02_15-13-06 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 37, 2025-06-02_15-13-06 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 34, 2025-06-02_15-13-06 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 33, 2025-06-02_15-13-06 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 38, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 46, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 47, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 44, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 43, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 41, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 42, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 45, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 39, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 40, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 48, 2025-06-03_13-59-05 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 49, 2025-06-06_14-52-03 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 50, 2025-06-12_16-11-15 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 51, 2025-06-12_16-11-15 ...</span></span>
<span><span class="co">## Estimating autocorrelation parameters for neuron 52, 2025-07-09_14-56-27 ...</span></span></code></pre>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Barkasi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
