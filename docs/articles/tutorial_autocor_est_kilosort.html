<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Autocorrelation estimation of KiloSort4 data â€¢ neurons</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Autocorrelation estimation of KiloSort4 data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neurons</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Introduction</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Package Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Installation</h6></li>
    <li><a class="dropdown-item" href="../articles/install.html">Installation instructions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial_autocor_est_kilosort.html">Autocorrelation estimation of KiloSort4 data</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial_autocor_est.html">Autocorrelation estimation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Legal</h6></li>
    <li><a class="dropdown-item" href="../articles/license.html">Dependency licenses</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/michaelbarkasi/neurons"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../#">ðŸŒ™</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Autocorrelation estimation of KiloSort4 data</h1>
            
      

      <div class="d-none name"><code>tutorial_autocor_est_kilosort.Rmd</code></div>
    </div>

    
    
<p>The neurons package provides functions to run a dichotomized Gaussian
(DG) analysis of spike autocorrelation on different kinds of data,
including KiloSort4 output. (Kilosort4 is a Python package for
extracting spike clusters from multi-channel probe recordings.) The aim
of this DG analysis of autocorrelation is to estimate the network time
constant of single auditory neurons in the left and right hemisphere of
various genotypes of mice. Network time constants provide an estimate of
recurrence. Specifically, a higher network time constant indicates that
a neuron receives a larger number of projections back on itself.
Intuitively, the longer into the future a spike <em>now</em> increases
the probability of a spike <em>later</em>, the stronger the connections
from that neuron back onto itself must be.</p>
<h1>
Setup
</h1>
<p>Begin by clearing the workspace, setting a random-number generator
seed, and loading the neurons package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clear the R workspace to start fresh</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Load neurons package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">neurons</span><span class="op">)</span> </span></code></pre></div>
<h1>
Load data
</h1>
<p>Provide the file path to the output from kilosort4.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set path to data </span></span>
<span><span class="va">demo_data</span> <span class="op">&lt;-</span> <span class="st">"/Users/michaelbarkasi/Library/CloudStorage/OneDrive-WashingtonUniversityinSt.Louis/projects_Oviedo_lab/_lateralized_recurrent_pathways/dichot-gaussian/data_demo"</span></span></code></pre></div>
<p>The function <strong>preprocess.kilo4</strong> is used to process the
kilosort4 output. This function expects its argument
<strong>data_path</strong> to point to a folder the subfolders of which
each contain a single kilosort4 output. This output should be in its own
folder <strong>kilosort4</strong>. The following four files are needed,
although others from kilosort4 can be in the directory as well:</p>
<ul>
<li>
<strong>spike_positions.npy</strong>: 2D array giving the x and y
position of each spike<br>
</li>
<li>
<strong>spike_clusters.npy</strong>: integer giving the cluster
number of each spike<br>
</li>
<li>
<strong>spike_times.npy</strong>: sample number the spike occurred
at<br>
</li>
<li>
<strong>cluster_group.tsv</strong> or
<strong>cluster_KSLabel.tsv</strong> or
<strong>cluster_info.tsv</strong>: 2D array giving status of each
cluster (0=noise, 1=MUA, 2=Good, 3=unsorted)</li>
</ul>
<p>In addition, a MATLAB file <strong>includeVector.mat</strong> giving
whether each cluster is stimulus-responisve (1) or not (0) should be
included in the kilosort4 folder. Finally, along with the kilosort4
subfolder, there should be a file <strong>StimulusStamps.csv</strong> in
each recording folder.</p>
<div class="figure">
<img src="fig_folderstructure.png" alt="Image showing folder structure necessary for &lt;b&gt;preprocess.kilo4&lt;/b&gt; function." width="90%"><p class="caption">
Folder structure necessary for <b>preprocess.kilo4</b> function.
</p>
</div>
<p>Metadata about the recordings is needed to supply covariates. For
this tutorial, a csv file with that data is in the neurons package
itself. It can be loaded with the regular <strong>read.csv</strong>
function in R.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load </span></span>
<span><span class="va">kilo4_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>, </span>
<span>    <span class="st">"meta_data_kilo4demo.csv"</span>, </span>
<span>    package <span class="op">=</span> <span class="st">"neurons"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kilo4_metadata</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          DAY Neuralynx_ID   EXPER HEMISPHERE PROBE COORDINATES_SHANK_1 COORDINATES_SHANK_2    STRAIN AGE SEX  DEPTH</span></span>
<span><span class="co">## 1 2025-02-06     13-06-34 001-001         RH  H10b                 0,0                 0,0       C57 P79   F 1156.0</span></span>
<span><span class="co">## 2 2025-02-06     14-03-05 001-002         RH  H10b                 0,0                 0,0       C57 P79   F 1209.0</span></span>
<span><span class="co">## 3 2025-02-06     15-36-59 001-004         RH  H10b                 0,0                 0,0       C57 P79   F 1003.0</span></span>
<span><span class="co">## 4 2025-02-06     15-53-03 001-005         RH  H10b                 0,0                 0,0       C57 P79   F 1003.0</span></span>
<span><span class="co">## 5 2025-02-20     16-19-12 001-001         RH  H10b                 0,0                 0,0 Mecp2 HET P79   F 1191.4</span></span>
<span><span class="co">## 6 2025-02-20     17-04-02 001-002         RH  H10b                 0,0                 0,0 Mecp2 HET P79   F 1191.4</span></span></code></pre>
<p>The neurons package (as of v1.0) can only handle certain covariates,
and expects them to have specific names (<strong>type</strong>,
<strong>genotype</strong>, <strong>sex</strong>, <strong>hemi</strong>,
<strong>region</strong>, <strong>age</strong>). The package also expects
the data frame holding those covariates to have rows labeled with
recording names that match the format of the recording names in the
data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Format and apply recording names to metadata as row names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">kilo4_metadata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="va">kilo4_metadata</span><span class="op">$</span><span class="va">DAY</span>, </span>
<span>  <span class="st">"_"</span>,</span>
<span>  <span class="va">kilo4_metadata</span><span class="op">$</span><span class="va">Neuralynx_ID</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep only the relevant columns (covariates of interest)</span></span>
<span><span class="va">kilo4_metadata</span> <span class="op">&lt;-</span> <span class="va">kilo4_metadata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HEMISPHERE"</span>,<span class="st">"STRAIN"</span>,<span class="st">"AGE"</span>,<span class="st">"SEX"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Rename columns to match what's expected by neurons package </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">kilo4_metadata</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hemi"</span>, <span class="st">"genotype"</span>, <span class="st">"age"</span>, <span class="st">"sex"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kilo4_metadata</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     hemi  genotype age sex</span></span>
<span><span class="co">## 2025-02-06_13-06-34   RH       C57 P79   F</span></span>
<span><span class="co">## 2025-02-06_14-03-05   RH       C57 P79   F</span></span>
<span><span class="co">## 2025-02-06_15-36-59   RH       C57 P79   F</span></span>
<span><span class="co">## 2025-02-06_15-53-03   RH       C57 P79   F</span></span>
<span><span class="co">## 2025-02-20_16-19-12   RH Mecp2 HET P79   F</span></span>
<span><span class="co">## 2025-02-20_17-04-02   RH Mecp2 HET P79   F</span></span></code></pre>
<h1>
Preprocess data into spike rasters
</h1>
<p>The function <strong>preprocess.kilo4</strong> converts cluster spike
times into spike rasters of the standardized format expected by the
neurons package. The recordings must be partitioned into trials, which
<strong>preprocess.kilo4</strong> does with start and stop times
relative to a stimulus. For example, information about responses to
stimuli can be analyzed by setting the start time to something negative
(before the stimulus) and the end time to something positive (after the
stimulus). However, for estimating autocorrelation, itâ€™s the spontaneous
activity during a period of silence after the stimulus which should be
analyzed. In this case, the start time should be some time after the
stimulus (to allow for settling) and the end time some time later.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spike.rasters.kilo4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess.kilo4.html">preprocess.kilo4</a></span><span class="op">(</span></span>
<span>  trial_time_start <span class="op">=</span> <span class="fl">500</span>,      <span class="co"># ms</span></span>
<span>  trial_time_end <span class="op">=</span> <span class="fl">500</span> <span class="op">+</span> <span class="fl">1520</span>, <span class="co"># ms</span></span>
<span>  recording.folder <span class="op">=</span> <span class="va">demo_data</span>,</span>
<span>  meta_data <span class="op">=</span> <span class="va">kilo4_metadata</span>, </span>
<span>  max_spikes <span class="op">=</span> <span class="fl">1e4</span>,</span>
<span>  min_spikes <span class="op">=</span> <span class="fl">1e2</span>,</span>
<span>  min_trials <span class="op">=</span> <span class="fl">1e2</span>,</span>
<span>  pure_trials_only <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  good_cells_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stim_responsive_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<p>A path (such as <strong>demo_data</strong>) for the actual data must
be passed to <strong>preprocess.kilo4</strong>. Metadata (such as
<strong>kilo4_metadata</strong>) will usually be provided, but is not
necessary for the function to run. If left out, the preprocessed output
will simply lack information about covariates.</p>
<p>In addition to the start and stop times and pointers to the data,
<strong>preprocess.kilo4</strong> has three Boolean variables
controlling the quality of clusters extracted for further analysis:</p>
<ul>
<li>
<strong>pure_trials_only</strong>: include only trials which do not
overlap with other trials (i.e., do not have a start time before the end
time of any previous trials)?</li>
<li>
<strong>good_cells_only</strong>: include only spike clusters which
passed hand curation?</li>
<li>
<strong>stim_responsive_only</strong>: include only spike clusters
which are responsive to stimuli?</li>
</ul>
<p>Three additional numeric variables are also useful for quality
control:</p>
<ul>
<li>
<strong>max_spikes</strong>: maximum number of spikes a cell can
have to be extracted</li>
<li>
<strong>min_spikes</strong>: minimum number of spikes a cell must
have to be extracted</li>
<li>
<strong>min_trials</strong>: minimum number of trials a cell must
have to be extracted</li>
</ul>
<p>Finally, if <strong>verbose</strong> is set to TRUE, the function
will print out information about the files it is finding and
parsing.</p>
<p>The output <strong>spike.rasters.kilo4</strong> is a list with three
elements: <strong>spikes</strong>, <strong>timeXtrial</strong>, and
<strong>cluster.key</strong>. The first element,
<strong>spikes</strong>, is a data frame giving a sparse representation
of the spike rasters from each recording. Each row is a spike, with
columns giving information such as cell number, time, and genotype. Here
are the first few rows of the <strong>spikes</strong> data frame:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">spikes</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      trial   sample cell time_in_ms      recording_name cluster hemi  genotype age sex</span></span>
<span><span class="co">## 3767     1 6881.530    1   503.2369 2025-04-05_11-50-43      17   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 3768     1 6884.632    2   506.3389 2025-04-05_11-50-43      34   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 3770     1 6888.790    3   510.4969 2025-04-05_11-50-43      82   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 3772     1 6892.552    4   514.2589 2025-04-05_11-50-43       1   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 3781     1 6903.673    5   525.3799 2025-04-05_11-50-43      12   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 3783     1 6906.115    2   527.8219 2025-04-05_11-50-43      34   RH Mecp2 HET P64   F</span></span></code></pre>
<p>The second element, <strong>timeXtrial</strong>, is a list of
matrices, one per cell, with rows corresponding to time bins and columns
to trials. Each entry is a binary indicator of whether the cell fired in
that time bin during that trial. (No example shown here.)</p>
<p>The third element, <strong>cluster.key</strong>, is a data frame with
rows representing cells and columns giving information such as cell
number, genotype, and number of spikes. Here are the first few rows of
the <strong>cluster.key</strong> data frame:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        recording.name cell cluster num.of.spikes num.of.responsive.trials hemi  genotype age sex</span></span>
<span><span class="co">## 1 2025-04-05_11-50-43    1      17          1869                      337   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 2 2025-04-05_11-50-43    2      34          1457                      271   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 3 2025-04-05_11-50-43    3      82          2321                      325   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 4 2025-04-05_11-50-43    4       1          2461                      396   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 5 2025-04-05_11-50-43    5      12          4153                      355   RH Mecp2 HET P64   F</span></span>
<span><span class="co">## 6 2025-04-05_11-50-43    6      95          2263                      360   RH Mecp2 HET P64   F</span></span></code></pre>
<p>Important summary information can be pulled from the
<strong>cluster.key</strong> data frame. For example, how many cells
were included in the output?</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of cells included:"</span>, <span class="va">n_cells</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of cells included: 37</span></span></code></pre>
<p>The number of cells and summary statistics such as mean spike and
trial count per covariate combination can be pulled as well: (Age left
off for simplicity.)</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all combinations of covariates</span></span>
<span><span class="va">covariate_combos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  genotype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">$</span><span class="va">genotype</span><span class="op">)</span>,</span>
<span>  hemi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">$</span><span class="va">hemi</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize variables to hold summary stats</span></span>
<span><span class="va">n_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covariate_combos</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mean_spikes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covariate_combos</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mean_trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covariate_combos</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop through combinations and get summary stats</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cv</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covariate_combos</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Get combination of covariates</span></span>
<span>  <span class="va">combo</span> <span class="op">&lt;-</span> <span class="va">covariate_combos</span><span class="op">[</span><span class="va">cv</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Subset cluster.key for this combination</span></span>
<span>  <span class="va">subset_key</span> <span class="op">&lt;-</span> <span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">[</span></span>
<span>    <span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">$</span><span class="va">genotype</span> <span class="op">==</span> <span class="va">combo</span><span class="op">$</span><span class="va">genotype</span> <span class="op">&amp;</span></span>
<span>    <span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">$</span><span class="va">hemi</span> <span class="op">==</span> <span class="va">combo</span><span class="op">$</span><span class="va">hemi</span> <span class="op">&amp;</span></span>
<span>    <span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">cluster.key</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="va">combo</span><span class="op">$</span><span class="va">sex</span>, </span>
<span>  <span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># If any cells in this combination, compute and save stats</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subset_key</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">n_cells</span><span class="op">[</span><span class="va">cv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">subset_key</span><span class="op">)</span></span>
<span>    <span class="va">mean_spikes</span><span class="op">[</span><span class="va">cv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">subset_key</span><span class="op">$</span><span class="va">num.of.spikes</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">mean_trials</span><span class="op">[</span><span class="va">cv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">subset_key</span><span class="op">$</span><span class="va">num.of.responsive.trials</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Print results </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">covariate_combos</span>, <span class="va">n_cells</span>, <span class="va">mean_spikes</span>, <span class="va">mean_trials</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     genotype hemi sex n_cells mean_spikes mean_trials</span></span>
<span><span class="co">## 1  Mecp2 HET   RH   F      26      1946.9       324.2</span></span>
<span><span class="co">## 2  Shank3 KO   RH   F      NA          NA          NA</span></span>
<span><span class="co">## 3        C57   RH   F      NA          NA          NA</span></span>
<span><span class="co">## 4  Mecp2 HET   LH   F      NA          NA          NA</span></span>
<span><span class="co">## 5  Shank3 KO   LH   F       1      1334.0       297.0</span></span>
<span><span class="co">## 6        C57   LH   F       1      2587.0       449.0</span></span>
<span><span class="co">## 7  Mecp2 HET   RH   M      NA          NA          NA</span></span>
<span><span class="co">## 8  Shank3 KO   RH   M      NA          NA          NA</span></span>
<span><span class="co">## 9        C57   RH   M      NA          NA          NA</span></span>
<span><span class="co">## 10 Mecp2 HET   LH   M      NA          NA          NA</span></span>
<span><span class="co">## 11 Shank3 KO   LH   M       9       728.0       173.0</span></span>
<span><span class="co">## 12       C57   LH   M      NA          NA          NA</span></span></code></pre>
<p>As can be seen, the above call to <strong>preprocess.kilo4</strong>
used strict quality control criteria, resulting in few cells being
extracted and most covariate combinations being either empty or having
only one cell. For comparison, letâ€™s relax the criteria by allowing
clusters which are not stimulus-responsive. Limiting to
stimulus-responsive cells guarantees that the cells are auditory, but
also excludes many cells.</p>
<h1>
Making neurons
</h1>
<p>With the kilosort4 data preprocessed into spike rasters, the next
step is to convert these rasters into a special class of object from the
neuron package, <strong>neuron</strong>. Letâ€™s convert both the strict
and relaxed versions of the spike rasters.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">neurons.kilo4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load.rasters.as.neurons.html">load.rasters.as.neurons</a></span><span class="op">(</span></span>
<span>  <span class="va">spike.rasters.kilo4</span><span class="op">$</span><span class="va">spikes</span>, </span>
<span>  sample_rt <span class="op">=</span> <span class="fl">1e3</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We want to load the spike rasters as <strong>neuron</strong>s because
<strong>neurons</strong>s come with built-in methods for plotting
rasters, plotting autocorrelation, and estimating autocorrelation
parameters with dichotomized Gaussian simulations.</p>
<p>For example, here is the raster from one cell:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_cell_num</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">example_raster1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot-raster.html">plot.raster</a></span><span class="op">(</span><span class="va">neurons.kilo4</span><span class="op">[[</span><span class="va">example_cell_num</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>  panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  plot.background  <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_raster1</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_autocor_est_kilosort_files/figure-html/plot_raster-1.png" width="700"></p>
<h1>
Estimate autocorrelation parameters
</h1>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute autocorrelation for example cell</span></span>
<span><span class="va">neurons.kilo4</span><span class="op">[[</span><span class="va">example_cell_num</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">compute_autocorrelation</span><span class="op">(</span><span class="st">"sum"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit exponential decay model to autocorrelation to estimate the network time constant (tau)</span></span>
<span><span class="va">neurons.kilo4</span><span class="op">[[</span><span class="va">example_cell_num</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">set_edf_initials</span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">neurons.kilo4</span><span class="op">[[</span><span class="va">example_cell_num</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">set_edf_termination</span><span class="op">(</span><span class="fl">1e-8</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">neurons.kilo4</span><span class="op">[[</span><span class="va">example_cell_num</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">fit_autocorrelation</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch and print estimated exponential decay parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">neurons.kilo4</span><span class="op">[[</span><span class="va">example_cell_num</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">fetch_EDF_parameters</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            A          tau    bias_term </span></span>
<span><span class="co">## 8.024077e-03 2.124888e+02 1.380757e-03</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot computed autocorrelation and fitted exponential decay</span></span>
<span><span class="va">example_autocor1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot-autocorrelation.html">plot.autocorrelation</a></span><span class="op">(</span><span class="va">neurons.kilo4</span><span class="op">[[</span><span class="va">example_cell_num</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>  panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  plot.background  <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_autocor1</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_autocor_est_kilosort_files/figure-html/plot_autocor-1.png" width="700"></p>
<p>The code above computes autocorrelation for one cell in a series of
steps. The neurons package provides a function,
<strong>process.autocorr</strong>, which does all of these steps in one
call for a list of neurons.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">autocor.results.batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process.autocorr.html">process.autocorr</a></span><span class="op">(</span><span class="va">neurons.kilo4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">autocor.results.batch</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     lambda_ms lambda_bin           A      tau    bias_term   autocorr1 max_autocorr mean_autocorr min_autocorr</span></span>
<span><span class="co">## 1 0.001857927 0.03715854 0.007969024 213.8234 0.0013807567 0.009349780  0.008638194   0.002193444 0.0013814473</span></span>
<span><span class="co">## 2 0.001448368 0.02896735 0.004604386 454.5239 0.0008391076 0.005443494  0.005245284   0.001850092 0.0008956254</span></span>
<span><span class="co">## 3 0.002307249 0.04614498 0.014520886 239.5948 0.0021293588 0.016650245  0.015487336   0.003796933 0.0021328003</span></span>
<span><span class="co">## 4 0.002446419 0.04892839 0.009859818 279.9206 0.0023939870 0.012253805  0.011573911   0.003724208 0.0024017653</span></span>
<span><span class="co">## 5 0.004128395 0.08256790 0.039748101 195.5211 0.0068174573 0.046565559  0.042700733   0.010507768 0.0068188925</span></span>
<span><span class="co">## 6 0.002249592 0.04499185 0.009970328 230.2125 0.0020242664 0.011994594  0.011164969   0.003122598 0.0020259480</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ... set number of sims to run per neuron</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># ... set number of trials to simulate per neuron</span></span>
<span><span class="va">n_trials</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="co"># ... run estimates on data</span></span>
<span><span class="va">autocor.ests.kilo4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.autocorr.params.html">estimate.autocorr.params</a></span><span class="op">(</span></span>
<span>  neuron_list <span class="op">=</span> <span class="va">neurons.kilo4</span>,</span>
<span>  n_trials_per_sim <span class="op">=</span> <span class="va">n_trials</span>, </span>
<span>  n_sims_per_neurons <span class="op">=</span> <span class="va">n_sims</span>, </span>
<span>  bin_count_action <span class="op">=</span> <span class="st">"sum"</span>,</span>
<span>  A0 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  tau0 <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>  ctol <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>  max_evals <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Run analysis:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">autocorr_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze.autocorr.html">analyze.autocorr</a></span><span class="op">(</span></span>
<span>  <span class="va">autocor.ests.kilo4</span>,</span>
<span>  covariate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hemi"</span>,<span class="st">"genotype"</span><span class="op">)</span>,</span>
<span>  n_bs <span class="op">=</span> <span class="fl">1e4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">autocorr_results</span>, use.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">autocorr_results</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">autocorr_results</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">title_size</span> <span class="op">&lt;-</span> <span class="fl">20</span> </span>
<span><span class="va">axis_size</span> <span class="op">&lt;-</span> <span class="fl">12</span> </span>
<span><span class="va">legend_size</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">example_stats1</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#scale_y_continuous(transform = "log1p") +</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Expected Time Constant"</span>, x <span class="op">=</span> <span class="st">"ms"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="va">title_size</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">axis_size</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">axis_size</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">legend_size</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">legend_size</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>  panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  plot.background  <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_stats1</span><span class="op">)</span></span></code></pre></div>
<p><img src="tutorial_autocor_est_kilosort_files/figure-html/stat_analysis-1.png" width="700"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Barkasi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
