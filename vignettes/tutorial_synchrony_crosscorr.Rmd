---
title: "Spike synchrony via cross-correlation"
---

```{r Rmdsetup, echo=FALSE}
# Set max width of markdown code outputs
options(width = 10000)
```

Intro here.

<h2>Load spike rasters</h2>

The first step is to set up the R environment by clearing the workspace, setting a random-number generator seed, and loading the neurons package.

```{r Rsetup}
# Clear the R workspace to start fresh
rm(list = ls())

# Set seed for reproducibility
set.seed(12345) 

# Load neurons package
library(neurons) 
```

```{r load_rasters}
spike.rasters <- read.csv(
  system.file(
      "extdata", 
      "cross_corr_demo_data.csv", 
      package = "neurons"
    )
  )
spike.rasters$genotype <- as.character(spike.rasters$genotype)
print(head(spike.rasters))
```

```{r}

same_penetration <- function(cell_num, raster = spike.rasters) {
  pen <- unique(raster$recording_name[raster$cell == cell_num])
  same_pen <- unique(raster$cell[raster$recording_name == pen])
  return(same_pen)
}
same_penetration(1)

neurons <- load.rasters.as.neurons(spike.rasters, bin_size = 10.0)

cross_corr <- neurons[[1]]$compute_crosscorrelation_R(neurons[[3]], "sum", 1000)

plot(cross_corr, type='l')

```